{{ define "main" }}
<!-- Page Header -->
<header class="page-header" style="margin-bottom: 48px; text-align: center;">
  <h1 style="font-size: 36px; font-weight: 700; margin-bottom: 12px; color: var(--color-text);">
    {{ if .IsHome }}
      {{ .Site.Title }}
    {{ else if eq .Section "posts" }}
      All Articles
    {{ else if .Title }}
      {{ .Title }}
    {{ else }}
      {{ .Site.Title }}
    {{ end }}
  </h1>

  {{ if .IsHome }}
    <p style="font-size: 18px; color: var(--color-text-secondary); margin-bottom: 0; max-width: 500px; margin-left: auto; margin-right: auto; line-height: 1.5;">
      {{ .Site.Params.description }}
    </p>
  {{ else if .Content }}
    <div style="font-size: 16px; color: var(--color-text-secondary); max-width: 500px; margin-left: auto; margin-right: auto;">
      {{ .Content }}
    </div>
  {{ end }}
</header>

<!-- Articles List -->
<div class="articles-list">
  {{ $pages := .Paginator.Pages }}
  {{ if $pages }}
    {{ $featuredPost := index $pages 0 }}
    {{ $otherPosts := after 1 $pages }}

    <!-- Featured Latest Post -->
    <article class="featured-post">
      <div class="featured-badge">Latest Post</div>

      <!-- Author and Date -->
      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
        {{ with $featuredPost.Params.author }}
          {{ $author := index site.Data.authors . }}
          {{ if $author }}
            <img src="{{ $author.avatar }}" alt="{{ $author.name }}"
                 style="width: 24px; height: 24px; border-radius: 50%;">
            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">{{ $author.name }}</span>
          {{ else }}
            <img src="/images/authors/default-avatar.png" alt="Unknown Author"
                 style="width: 24px; height: 24px; border-radius: 50%;">
            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">Unknown Author</span>
          {{ end }}
        {{ else }}
          <img src="/images/authors/default-avatar.png" alt="Unknown Author"
               style="width: 24px; height: 24px; border-radius: 50%;">
          <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">Unknown Author</span>
        {{ end }}

        <span style="color: var(--color-text-light); font-size: var(--font-size-sm);">·</span>
        <time datetime="{{ $featuredPost.Date | time.Format "2006-01-02T15:04:05-07:00" }}"
              style="font-size: var(--font-size-sm); color: var(--color-text-light);">
          {{ $featuredPost.Date.Format "Jan 2" }}
        </time>

        {{ if $featuredPost.ReadingTime }}
          <span style="color: var(--color-text-light); font-size: var(--font-size-sm);">·</span>
          <span style="font-size: var(--font-size-sm); color: var(--color-text-light);">
            {{ $featuredPost.ReadingTime }} min read
          </span>
        {{ end }}
      </div>

      <!-- Featured Post Title -->
      <h2 class="post-title" style="margin: 0 0 16px 0;">
        <a href="{{ $featuredPost.RelPermalink }}"
           style="color: var(--color-text); text-decoration: none; display: block; transition: color 0.2s ease;"
           onmouseover="this.style.color='var(--color-primary)'"
           onmouseout="this.style.color='var(--color-text)'">
          {{ $featuredPost.Title }}
        </a>
      </h2>

      <!-- Featured Post Summary -->
      <p class="post-summary" style="margin: 0 0 20px 0;">
        {{ if $featuredPost.Summary }}
          {{ $featuredPost.Summary | truncate 200 }}
        {{ else }}
          {{ $featuredPost.Content | plainify | truncate 200 }}
        {{ end }}
      </p>

      <!-- Featured Post Tags -->
      {{ if $featuredPost.Params.tags }}
        <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px;">
          {{ range first 4 $featuredPost.Params.tags }}
            <span style="background-color: var(--color-bg-secondary); color: var(--color-text-light); padding: 4px 12px; border-radius: 16px; font-size: var(--font-size-xs); font-weight: var(--font-weight-medium);">
              {{ . }}
            </span>
          {{ end }}
        </div>
      {{ end }}

      <!-- Read More Button -->
      <a href="{{ $featuredPost.RelPermalink }}"
         style="display: inline-block; background-color: var(--color-primary); color: white; padding: 12px 24px; border-radius: 6px; text-decoration: none; font-weight: var(--font-weight-medium); font-size: var(--font-size-sm); transition: background-color 0.2s ease;"
         onmouseover="this.style.backgroundColor='var(--color-primary-hover)'"
         onmouseout="this.style.backgroundColor='var(--color-primary)'">
        Read Full Article →
      </a>
    </article>

    <!-- Other Posts -->
    {{ if $otherPosts }}
      <div style="display: grid; gap: 24px; margin-top: 32px;">
        {{ range $otherPosts }}
          <article style="padding: 20px 0; border-bottom: 1px solid var(--color-border-light); transition: transform 0.2s ease;"
                   onmouseover="this.style.transform='translateX(4px)'"
                   onmouseout="this.style.transform='translateX(0)'">
            <!-- Author and Date -->
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
              {{ with .Params.author }}
                {{ $author := index site.Data.authors . }}
                {{ if $author }}
                  <img src="{{ $author.avatar }}" alt="{{ $author.name }}"
                       style="width: 18px; height: 18px; border-radius: 50%;">
                  <span style="font-size: var(--font-size-xs); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">{{ $author.name }}</span>
                {{ else }}
                  <img src="/images/authors/default-avatar.png" alt="Unknown Author"
                       style="width: 18px; height: 18px; border-radius: 50%;">
                  <span style="font-size: var(--font-size-xs); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">Unknown Author</span>
                {{ end }}
              {{ else }}
                <img src="/images/authors/default-avatar.png" alt="Unknown Author"
                     style="width: 18px; height: 18px; border-radius: 50%;">
                <span style="font-size: var(--font-size-xs); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">Unknown Author</span>
              {{ end }}

              <span style="color: var(--color-text-light); font-size: var(--font-size-xs);">·</span>
              <time datetime="{{ .Date | time.Format "2006-01-02T15:04:05-07:00" }}"
                    style="font-size: var(--font-size-xs); color: var(--color-text-light);">
                {{ .Date.Format "Jan 2" }}
              </time>

              {{ if .ReadingTime }}
                <span style="color: var(--color-text-light); font-size: var(--font-size-xs);">·</span>
                <span style="font-size: var(--font-size-xs); color: var(--color-text-light);">
                  {{ .ReadingTime }} min read
                </span>
              {{ end }}
            </div>

            <!-- Article Title -->
            <h3 style="margin: 0 0 8px 0;">
              <a href="{{ .RelPermalink }}"
                 style="color: var(--color-text); text-decoration: none; font-size: 20px; font-weight: 600; line-height: 1.3; display: block; transition: color 0.2s ease;"
                 onmouseover="this.style.color='var(--color-primary)'"
                 onmouseout="this.style.color='var(--color-text)'">
                {{ .Title }}
              </a>
            </h3>

            <!-- Article Summary -->
            <p style="font-size: 15px; color: var(--color-text-secondary); line-height: 1.5; margin: 0 0 12px 0;">
              {{ if .Summary }}
                {{ .Summary | truncate 120 }}
              {{ else }}
                {{ .Content | plainify | truncate 120 }}
              {{ end }}
            </p>

            <!-- Tags -->
            {{ if .Params.tags }}
              <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                {{ range first 3 .Params.tags }}
                  <span style="background-color: var(--color-bg-secondary); color: var(--color-text-light); padding: 2px 8px; border-radius: 12px; font-size: var(--font-size-xs); font-weight: var(--font-weight-medium);">
                    {{ . }}
                  </span>
                {{ end }}
              </div>
            {{ end }}
          </article>
        {{ end }}
      </div>
    {{ end }}
  {{ end }}
</div>

<!-- Pagination -->
{{ if or .Paginator.HasPrev .Paginator.HasNext }}
  <nav class="pagination" style="display: flex; justify-content: center; align-items: center; gap: 16px; margin-top: 48px; padding-top: 24px; border-top: 1px solid var(--color-border);">
    {{ if .Paginator.HasPrev }}
      <a href="{{ .Paginator.Prev.URL }}"
         style="color: var(--color-text-secondary); text-decoration: none; font-weight: var(--font-weight-medium); padding: 8px 16px; border: 1px solid var(--color-border); border-radius: 6px; transition: all 0.2s ease; font-size: var(--font-size-sm);"
         onmouseover="this.style.borderColor='var(--color-text)'; this.style.color='var(--color-text)'"
         onmouseout="this.style.borderColor='var(--color-border)'; this.style.color='var(--color-text-secondary)'">
        ← Previous
      </a>
    {{ end }}

    {{ if .Paginator.HasNext }}
      <a href="{{ .Paginator.Next.URL }}"
         style="color: var(--color-text-secondary); text-decoration: none; font-weight: var(--font-weight-medium); padding: 8px 16px; border: 1px solid var(--color-border); border-radius: 6px; transition: all 0.2s ease; font-size: var(--font-size-sm);"
         onmouseover="this.style.borderColor='var(--color-text)'; this.style.color='var(--color-text)'"
         onmouseout="this.style.borderColor='var(--color-border)'; this.style.color='var(--color-text-secondary)'">
        Next →
      </a>
    {{ end }}
  </nav>
{{ end }}

<!-- Subscribe Section (only on home page) -->
{{ if .IsHome }}
  <section id="subscribe" style="margin-top: 64px; padding: 32px 24px; background-color: var(--color-bg-secondary); border-radius: 8px; text-align: center; transition: background-color 0.3s ease;">
    <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 8px; color: var(--color-text);">
      Subscribe to {{ .Site.Title }}
    </h3>
    <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-bottom: 24px; max-width: 320px; margin-left: auto; margin-right: auto;">
      Get the latest articles and insights delivered to your inbox.
    </p>

    <!-- Simple subscribe form -->
    <form style="display: flex; gap: 8px; max-width: 320px; margin: 0 auto; flex-wrap: wrap;"
          action="#" method="post">
      <input type="email"
             placeholder="Enter your email"
             style="flex: 1; min-width: 200px; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: 6px; font-size: var(--font-size-sm); background-color: var(--color-bg); color: var(--color-text); transition: all 0.3s ease;">
      <button type="submit"
              style="background-color: var(--color-primary); color: white; border: none; padding: 10px 16px; border-radius: 6px; font-weight: var(--font-weight-medium); cursor: pointer; transition: background-color 0.2s ease; font-size: var(--font-size-sm);"
              onmouseover="this.style.backgroundColor='var(--color-primary-hover)'"
              onmouseout="this.style.backgroundColor='var(--color-primary)'">
        Subscribe
      </button>
    </form>

    <p style="font-size: var(--font-size-xs); color: var(--color-text-light); margin-top: 12px;">
      No spam, unsubscribe at any time.
    </p>
  </section>
{{ end }}
{{ end }}
