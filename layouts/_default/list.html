{{ define "main" }}
<!-- Page Header -->
<header class="page-header" style="margin-bottom: 48px; text-align: center;">
  <h1 style="font-size: 36px; font-weight: 700; margin-bottom: 12px; color: var(--color-text);">
    {{ if .IsHome }}
      {{ .Site.Title }}
    {{ else if eq .Section "posts" }}
      All Articles
    {{ else if .Title }}
      {{ .Title }}
    {{ else }}
      {{ .Site.Title }}
    {{ end }}
  </h1>

  {{ if .IsHome }}
    <p style="font-size: 18px; color: var(--color-text-secondary); margin-bottom: 0; max-width: 500px; margin-left: auto; margin-right: auto; line-height: 1.5;">
      {{ .Site.Params.description }}
    </p>
  {{ else if .Content }}
    <div style="font-size: 16px; color: var(--color-text-secondary); max-width: 500px; margin-left: auto; margin-right: auto;">
      {{ .Content }}
    </div>
  {{ end }}
</header>

<!-- Articles List -->
<div class="articles-list">
  {{ range .Paginator.Pages }}
    <article class="article-item" style="padding: 24px 0; border-bottom: 1px solid var(--color-border-light); margin-bottom: 8px;">
      <!-- Author and Date -->
      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
        {{ with .Params.author }}
          {{ $author := index site.Data.authors . }}
          {{ if $author }}
            <img src="{{ $author.avatar }}" alt="{{ $author.name }}"
                 style="width: 20px; height: 20px; border-radius: 50%;">
            <span style="font-size: var(--font-size-xs); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">{{ $author.name }}</span>
          {{ else }}
            <img src="/images/authors/default-avatar.png" alt="Unknown Author"
                 style="width: 20px; height: 20px; border-radius: 50%;">
            <span style="font-size: var(--font-size-xs); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">Unknown Author</span>
          {{ end }}
        {{ else }}
          <img src="/images/authors/default-avatar.png" alt="Unknown Author"
               style="width: 20px; height: 20px; border-radius: 50%;">
          <span style="font-size: var(--font-size-xs); color: var(--color-text-secondary); font-weight: var(--font-weight-medium);">Unknown Author</span>
        {{ end }}

        <span style="color: var(--color-text-light); font-size: var(--font-size-xs);">·</span>
        <time datetime="{{ .Date | time.Format "2006-01-02T15:04:05-07:00" }}"
              style="font-size: var(--font-size-xs); color: var(--color-text-light);">
          {{ .Date.Format "Jan 2" }}
        </time>

        {{ if .ReadingTime }}
          <span style="color: var(--color-text-light); font-size: var(--font-size-xs);">·</span>
          <span style="font-size: var(--font-size-xs); color: var(--color-text-light);">
            {{ .ReadingTime }} min read
          </span>
        {{ end }}
      </div>

      <!-- Article Title -->
      <h2 style="margin: 0 0 8px 0;">
        <a href="{{ .RelPermalink }}"
           style="color: var(--color-text); text-decoration: none; font-size: 22px; font-weight: 700; line-height: 1.3; display: block;">
          {{ .Title }}
        </a>
      </h2>

      <!-- Article Summary -->
      <p style="font-size: 16px; color: var(--color-text-secondary); line-height: 1.5; margin: 0 0 12px 0;">
        {{ if .Summary }}
          {{ .Summary | truncate 140 }}
        {{ else }}
          {{ .Content | plainify | truncate 140 }}
        {{ end }}
      </p>

      <!-- Tags -->
      {{ if .Params.tags }}
        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
          {{ range first 3 .Params.tags }}
            <span style="background-color: var(--color-bg-secondary); color: var(--color-text-light); padding: 2px 8px; border-radius: 12px; font-size: var(--font-size-xs); font-weight: var(--font-weight-medium);">
              {{ . }}
            </span>
          {{ end }}
        </div>
      {{ end }}
    </article>
  {{ end }}
</div>

<!-- Pagination -->
{{ if or .Paginator.HasPrev .Paginator.HasNext }}
  <nav class="pagination" style="display: flex; justify-content: center; align-items: center; gap: 16px; margin-top: 48px; padding-top: 24px; border-top: 1px solid var(--color-border);">
    {{ if .Paginator.HasPrev }}
      <a href="{{ .Paginator.Prev.URL }}"
         style="color: var(--color-text-secondary); text-decoration: none; font-weight: var(--font-weight-medium); padding: 8px 16px; border: 1px solid var(--color-border); border-radius: 6px; transition: all 0.2s ease; font-size: var(--font-size-sm);"
         onmouseover="this.style.borderColor='var(--color-text)'; this.style.color='var(--color-text)'"
         onmouseout="this.style.borderColor='var(--color-border)'; this.style.color='var(--color-text-secondary)'">
        ← Previous
      </a>
    {{ end }}

    {{ if .Paginator.HasNext }}
      <a href="{{ .Paginator.Next.URL }}"
         style="color: var(--color-text-secondary); text-decoration: none; font-weight: var(--font-weight-medium); padding: 8px 16px; border: 1px solid var(--color-border); border-radius: 6px; transition: all 0.2s ease; font-size: var(--font-size-sm);"
         onmouseover="this.style.borderColor='var(--color-text)'; this.style.color='var(--color-text)'"
         onmouseout="this.style.borderColor='var(--color-border)'; this.style.color='var(--color-text-secondary)'">
        Next →
      </a>
    {{ end }}
  </nav>
{{ end }}

<!-- Subscribe Section (only on home page) -->
{{ if .IsHome }}
  <section id="subscribe" style="margin-top: 64px; padding: 32px 24px; background-color: var(--color-bg-secondary); border-radius: 8px; text-align: center;">
    <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 8px; color: var(--color-text);">
      Subscribe to {{ .Site.Title }}
    </h3>
    <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-bottom: 24px; max-width: 320px; margin-left: auto; margin-right: auto;">
      Get the latest articles and insights delivered to your inbox.
    </p>

    <!-- Simple subscribe form -->
    <form style="display: flex; gap: 8px; max-width: 320px; margin: 0 auto; flex-wrap: wrap;"
          action="#" method="post">
      <input type="email"
             placeholder="Enter your email"
             style="flex: 1; min-width: 200px; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: 6px; font-size: var(--font-size-sm); background-color: var(--color-bg);">
      <button type="submit"
              style="background-color: var(--color-primary); color: white; border: none; padding: 10px 16px; border-radius: 6px; font-weight: var(--font-weight-medium); cursor: pointer; transition: background-color 0.2s ease; font-size: var(--font-size-sm);"
              onmouseover="this.style.backgroundColor='var(--color-primary-hover)'"
              onmouseout="this.style.backgroundColor='var(--color-primary)'">
        Subscribe
      </button>
    </form>

    <p style="font-size: var(--font-size-xs); color: var(--color-text-light); margin-top: 12px;">
      No spam, unsubscribe at any time.
    </p>
  </section>
{{ end }}
{{ end }}
